!function(a){"use strict";var b=a.fabric||(a.fabric={});b.util.object.extend(b.Image.prototype,{applyFilters:function(a,c,d,e){if(c=c||this.filters,d=d||this._originalElement){var f=d,g=b.util.createCanvasElement(),h=b.util.createImage(),i=this;return g.width=f.width,g.height=f.height,g.getContext("2d").drawImage(f,0,0,f.width,f.height),0===c.length?(this._element=d,a&&a(),g):(c.forEach(function(a){"undefined"!=typeof Promise?a&&a.applyTo(g,a.scaleX||i.scaleX,a.scaleY||i.scaleY).then(function(a){h.src=a.toDataURL("image/png")}):b.warn("Promises are not support in your browser"),!e&&a&&"Resize"===a.type&&(i.width*=a.scaleX,i.height*=a.scaleY)}),h.width=g.width,h.height=g.height,b.isLikelyNode?(h.src=g.toBuffer(void 0,b.Image.pngCompression),i._element=h,!e&&(i._filteredEl=h),a&&a()):h.onload=function(){i._element=h,!e&&(i._filteredEl=h),a&&a(),h.onload=g=f=null},g)}}})}("undefined"!=typeof exports?exports:this);